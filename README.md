# Проект: Предсказание стоимости автомобилей и разработка веб-интерфейса для применения модели

## 1. Описание проекта

Цель проекта — разработка и анализ модели машинного обучения для предсказания рыночной стоимости автомобилей по их характеристикам, а также создание веб-приложения для удобного применения модели и демонстрации результатов анализа данных.

Работа состоит из двух основных частей:

1. исследование и предобработка данных, построение модели;
2. разработка Streamlit-приложения для визуализации и предсказаний.

---

## 2. Данные

Входные данные содержат технические характеристики автомобилей, а также их фактическую цену.  
Используемые признаки включают:

- год выпуска,
- пробег,
- тип топлива,
- тип коробки передач,
- продавец,
- число владельцев,
- показатели мощности и объёма двигателя,
- дополнительные категориальные характеристики.

---

## 3. Предобработка данных

Были выполнены следующие шаги:

1. Поиск и обработка пропусков (заполнение медианными значениями).
2. Приведение строковых числовых характеристик (`mileage`, `engine`, `max_power`) к числовому формату.
3. Удаление столбца `torque` из-за сильной несогласованности формата.
4. Удаление полных и частичных дубликатов.
5. Приведение типов данных.
6. Кодирование категориальных признаков методом One-Hot Encoding.
7. Формирование итоговых наборов признаков `X_train_full` и `X_test_full`.

---

## 4. Анализ данных (EDA)

Проведено исследование следующих аспектов:

- распределения числовых признаков,
- взаимосвязи между признаками,
- корреляции между переменными,
- сравнение train/test выборок.

---

## 5. Моделирование

Обучены и протестированы следующие модели:

| Модель | R² (train) | R² (test) | MSE (test) |
|-------|------------|------------|-------------|
| Linear Regression | ≈ 0.59 | ≈ 0.59 | высокая |
| Linear Regression (масштабирование) | ≈ 0.59 | ≈ 0.59 | без улучшений |
| Lasso | ≈ 0.57 | ≈ 0.57 | средняя |
| ElasticNet | ≈ 0.57 | ≈ 0.57 | средняя |
| **Ridge (GridSearchCV)** | **≈ 0.97** | **≈ 0.94** | **наилучший результат** |

Оптимальное значение параметра регуляризации:  
**alpha = 0.1**

---

## 6. Интерпретация модели

Наиболее значимыми признаками (по модулю коэффициента) являются:

1. `max_power`
2. `engine`
3. `year`
4. `km_driven`

---

## 7. Выводы по результатам моделирования

- Увеличение качества достигнуто за счёт добавления категориальных признаков и регуляризации (Ridge).
- Модели Lasso и ElasticNet не дали увеличения точности из-за отсутствия неинформативных признаков, которые могли бы быть занулены.
- Стандартизация не дала прироста качества для линейной регрессии.

---

## 8. Ограничения проекта

- Приложение принимает только **предварительно подготовленные данные**, соответствующие структуре `X_train_full`.
- Пайплайн предобработки не реализован внутри Streamlit.
- Столбец `name` был удалён, что может снижать потенциал модели.
- Признак `torque` исключён из-за сложности структурирования.

---

## 9. Streamlit-приложение

Приложение содержит три функциональных раздела:

### 9.1. EDA
Позволяет загрузить CSV-файл с таргетом и построить базовые визуализации:
- первые строки таблицы;
- гистограммы числовых признаков;
- матрица корреляций.

### 9.2. Предсказание
Позволяет загрузить подготовленный CSV без таргета и получить прогноз стоимости.  
Таргет при наличии удаляется автоматически.

### 9.3. Веса модели
Отображает таблицу коэффициентов модели и график наиболее значимых признаков.

---

## 10. Структура проекта

```
project/
│
├── app.py
├── README.md
├── requirements.txt
├── runtime.txt
├── example_input.csv
│
├── models/
│   ├── ridge_model.pkl
│   └── feature_names.pkl
│
└── notebook.ipynb
```

---

## 11. Установка и запуск приложения

Готовое приложение Streamlit доступно по ссылке:  
https://hw1regression-ikd9o82ve9tonphdhbxkxq.streamlit.app

### Установка зависимостей:
```
pip install -r requirements.txt
```

### Запуск приложения:
```
streamlit run app.py
```

---

## 12. Дополнительный файл: `feature_names.pkl`

Файл `feature_names.pkl` содержит список признаков, использованных при обучении модели.  
В текущей версии приложения он **не используется**, поскольку список признаков извлекается непосредственно из объекта модели.
